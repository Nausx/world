From 266ddc3e38107862811927371cbf4b88fdfe4872 Mon Sep 17 00:00:00 2001
Message-Id: <266ddc3e38107862811927371cbf4b88fdfe4872.1502135873.git.jan.steffens@gmail.com>
From: "Jan Alexander Steffens (heftig)" <jan.steffens@gmail.com>
Date: Mon, 7 Aug 2017 20:55:35 +0200
Subject: [PATCH 1/3] meson: Use configure_file() to copy typesfile

The working directory is the builddir and gnome.gtkdoc is not smart
enough to figure out whether the filename(s) passed are found in the
builddir or srcdir. Using files() doesn't help, either, since it always
generates paths to the builddir.

Other projects (GStreamer, Grilo) seem to use configure_file to copy the
typesfile to the builddir. Follow this.

This fixes the following error:

    Cannot open gdk-pixbuf.types: No such file or directory
---
 docs/reference/gdk-pixbuf/meson.build | 4 ++++
 1 file changed, 4 insertions(+)

diff --git a/docs/reference/gdk-pixbuf/meson.build b/docs/reference/gdk-pixbuf/meson.build
index 47f241094b4bf16c..6762d8da44f5c57c 100644
--- a/docs/reference/gdk-pixbuf/meson.build
+++ b/docs/reference/gdk-pixbuf/meson.build
@@ -21,6 +21,10 @@ private_headers = [
 ]
 
 if get_option('with_docs')
+  configure_file(input: 'gdk-pixbuf.types',
+                 output: 'gdk-pixbuf.types',
+                 configuration: configuration_data())
+
   gnome.gtkdoc('gdk-pixbuf',
                main_xml: 'gdk-pixbuf.xml',
                src_dir: [

base-commit: 31c0a1f43aaeddef706057065e38bbfc205dbbe0
-- 
2.13.2


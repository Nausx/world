From d2b3d6667f1f767d96e084a8babef16d87dddf02 Mon Sep 17 00:00:00 2001
Message-Id: <d2b3d6667f1f767d96e084a8babef16d87dddf02.1502618072.git.jan.steffens@gmail.com>
From: "Jan Alexander Steffens (heftig)" <jan.steffens@gmail.com>
Date: Sun, 13 Aug 2017 11:36:15 +0200
Subject: [PATCH] gdk-pixbuf-xlib: Mark public funcs _GDK_PIXBUF_EXTERN

Without this, the meson-built libgdk_pixbuf_xlib has no exports at all.
---
 contrib/gdk-pixbuf-xlib/gdk-pixbuf-xlib.h    |  7 +++++++
 contrib/gdk-pixbuf-xlib/gdk-pixbuf-xlibrgb.h | 24 +++++++++++++++++++++++-
 2 files changed, 30 insertions(+), 1 deletion(-)

diff --git a/contrib/gdk-pixbuf-xlib/gdk-pixbuf-xlib.h b/contrib/gdk-pixbuf-xlib/gdk-pixbuf-xlib.h
index c755546818b2e127..d81db1b36dc82a73 100644
--- a/contrib/gdk-pixbuf-xlib/gdk-pixbuf-xlib.h
+++ b/contrib/gdk-pixbuf-xlib/gdk-pixbuf-xlib.h
@@ -30,49 +30,56 @@ G_BEGIN_DECLS
 
 /* init */
 
+_GDK_PIXBUF_EXTERN
 void gdk_pixbuf_xlib_init (Display *display, int screen_num);
 
+_GDK_PIXBUF_EXTERN
 void gdk_pixbuf_xlib_init_with_depth (Display *display, int screen_num,
 				      int prefDepth);
 
 
 
 /* render */
 
+_GDK_PIXBUF_EXTERN
 void gdk_pixbuf_xlib_render_threshold_alpha (GdkPixbuf *pixbuf, Pixmap bitmap,
 					     int src_x, int src_y,
 					     int dest_x, int dest_y,
 					     int width, int height,
 					     int alpha_threshold);
 
+_GDK_PIXBUF_EXTERN
 void gdk_pixbuf_xlib_render_to_drawable (GdkPixbuf *pixbuf,
 					 Drawable drawable, GC gc,
 					 int src_x, int src_y,
 					 int dest_x, int dest_y,
 					 int width, int height,
 					 XlibRgbDither dither,
 					 int x_dither, int y_dither);
 
 
+_GDK_PIXBUF_EXTERN
 void gdk_pixbuf_xlib_render_to_drawable_alpha (GdkPixbuf *pixbuf,
 					       Drawable drawable,
 					       int src_x, int src_y,
 					       int dest_x, int dest_y,
 					       int width, int height,
 					       GdkPixbufAlphaMode alpha_mode,
 					       int alpha_threshold,
 					       XlibRgbDither dither,
 					       int x_dither, int y_dither);
 
+_GDK_PIXBUF_EXTERN
 void gdk_pixbuf_xlib_render_pixmap_and_mask (GdkPixbuf *pixbuf,
 					     Pixmap *pixmap_return,
 					     Pixmap *mask_return,
 					     int alpha_threshold);
 
 
 
 /* drawable */
 
+_GDK_PIXBUF_EXTERN
 GdkPixbuf *gdk_pixbuf_xlib_get_from_drawable (GdkPixbuf *dest,
 					      Drawable src,
 					      Colormap cmap, Visual *visual,
diff --git a/contrib/gdk-pixbuf-xlib/gdk-pixbuf-xlibrgb.h b/contrib/gdk-pixbuf-xlib/gdk-pixbuf-xlibrgb.h
index f838ea8079d43cc1..689d4f75fd131fce 100644
--- a/contrib/gdk-pixbuf-xlib/gdk-pixbuf-xlibrgb.h
+++ b/contrib/gdk-pixbuf-xlib/gdk-pixbuf-xlibrgb.h
@@ -51,37 +51,42 @@
 #ifndef __XLIB_RGB_H__
 #define __XLIB_RGB_H__
 
-#include <glib.h>
+#include <gdk-pixbuf/gdk-pixbuf.h>
 
 G_BEGIN_DECLS
 
 #include <X11/Xlib.h>
 #include <X11/Xutil.h>
 
 /**
  * XlibRgbCmap:
  * @colors: FIXME.
  * @lut: FIXME.
  * 
  *     FIXME: Describe this.
  */
 typedef struct _XlibRgbCmap XlibRgbCmap;
 struct _XlibRgbCmap {
   unsigned int colors[256];
   unsigned char lut[256]; /* for 8-bit modes */
 };
 
+_GDK_PIXBUF_EXTERN
 void
 xlib_rgb_init (Display *display, Screen *screen);
+_GDK_PIXBUF_EXTERN
 void
 xlib_rgb_init_with_depth (Display *display, Screen *screen, int prefDepth);
 
+_GDK_PIXBUF_EXTERN
 unsigned long
 xlib_rgb_xpixel_from_rgb (guint32 rgb);
 
+_GDK_PIXBUF_EXTERN
 void
 xlib_rgb_gc_set_foreground (GC gc, guint32 rgb);
 
+_GDK_PIXBUF_EXTERN
 void
 xlib_rgb_gc_set_background (GC gc, guint32 rgb);
 
@@ -109,100 +114,117 @@ typedef enum
   XLIB_RGB_DITHER_MAX
 } XlibRgbDither;
 
+_GDK_PIXBUF_EXTERN
 void
 xlib_draw_rgb_image (Drawable drawable,
 		     GC gc,
 		     int x,
 		     int y,
 		     int width,
 		     int height,
 		     XlibRgbDither dith,
 		     unsigned char *rgb_buf,
 		     int rowstride);
 
+_GDK_PIXBUF_EXTERN
 void
 xlib_draw_rgb_image_dithalign (Drawable drawable,
 			       GC gc,
 			       int x,
 			       int y,
 			       int width,
 			       int height,
 			       XlibRgbDither dith,
 			       unsigned char *rgb_buf,
 			       int rowstride,
 			       int xdith,
 			       int ydith);
 
+_GDK_PIXBUF_EXTERN
 void
 xlib_draw_rgb_32_image (Drawable drawable,
 			GC gc,
 			int x,
 			int y,
 			int width,
 			int height,
 			XlibRgbDither dith,
 			unsigned char *buf,
 			int rowstride);
 
+_GDK_PIXBUF_EXTERN
 void
 xlib_draw_gray_image (Drawable drawable,
 		      GC gc,
 		      int x,
 		      int y,
 		      int width,
 		      int height,
 		      XlibRgbDither dith,
 		      unsigned char *buf,
 		      int rowstride);
 
+_GDK_PIXBUF_EXTERN
 XlibRgbCmap *
 xlib_rgb_cmap_new (guint32 *colors, int n_colors);
 
+_GDK_PIXBUF_EXTERN
 void
 xlib_rgb_cmap_free (XlibRgbCmap *cmap);
 
+_GDK_PIXBUF_EXTERN
 void
 xlib_draw_indexed_image (Drawable drawable,
                          GC gc,
                          int x,
                          int y,
                          int width,
                          int height,
                          XlibRgbDither dith,
                          unsigned char *buf,
                          int rowstride,
                          XlibRgbCmap *cmap);
 
 /* Below are some functions which are primarily useful for debugging
    and experimentation. */
+_GDK_PIXBUF_EXTERN
 Bool
 xlib_rgb_ditherable (void);
 
+_GDK_PIXBUF_EXTERN
 void
 xlib_rgb_set_verbose (Bool verbose);
 
 /* experimental colormap stuff */
+_GDK_PIXBUF_EXTERN
 void
 xlib_rgb_set_install (Bool install);
 
+_GDK_PIXBUF_EXTERN
 void
 xlib_rgb_set_min_colors (int min_colors);
 
+_GDK_PIXBUF_EXTERN
 Colormap
 xlib_rgb_get_cmap (void);
 
+_GDK_PIXBUF_EXTERN
 Visual *
 xlib_rgb_get_visual (void);
 
+_GDK_PIXBUF_EXTERN
 XVisualInfo *
 xlib_rgb_get_visual_info (void);
 
+_GDK_PIXBUF_EXTERN
 int
 xlib_rgb_get_depth (void);
 
+_GDK_PIXBUF_EXTERN
 Display *
 xlib_rgb_get_display (void);
 
+_GDK_PIXBUF_EXTERN
 Screen *
 xlib_rgb_get_screen (void);
 

base-commit: 43655b14b176f3cf027e313aed7835d89d077e1d
prerequisite-patch-id: 86cfadc78ae46f013949400be50c6ee5dbf7b45e
prerequisite-patch-id: 0eed2942b2e2937daf34f30aac3d21ec5581e0a5
prerequisite-patch-id: 41089e023cf12231a08bd99d3b61050d40b12324
-- 
2.14.1

